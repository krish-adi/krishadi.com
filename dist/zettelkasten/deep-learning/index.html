<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-kast/deep-learning">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Deep Learning | Adithya Krishnan</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://krishadi.com.com/zettelkasten/deep-learning"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="snowflake, sql, machine learning, python, data warehouse, large language models, prompt, prompt engineering"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Deep Learning | Adithya Krishnan"><meta data-rh="true" name="description" content="Deep-learning quick reference cheat sheet"><meta data-rh="true" property="og:description" content="Deep-learning quick reference cheat sheet"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://krishadi.com.com/zettelkasten/deep-learning"><link data-rh="true" rel="alternate" href="https://krishadi.com.com/zettelkasten/deep-learning" hreflang="en"><link data-rh="true" rel="alternate" href="https://krishadi.com.com/zettelkasten/deep-learning" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-62QSD7Z9M4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-62QSD7Z9M4",{})</script><link rel="stylesheet" href="/assets/css/styles.4d4d5d8a.css">
<link rel="preload" href="/assets/js/runtime~main.130bfcb2.js" as="script">
<link rel="preload" href="/assets/js/main.e508e2d1.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-light.svg" alt="adithya krishnan" class="themedImage_ToTc themedImage--light_HNdA" style="height:24px"><img src="/img/logo-dark.svg" alt="adithya krishnan" class="themedImage_ToTc themedImage--dark_i4oU" style="height:24px"></div></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><a class="navbar__item navbar__link" href="/about">About</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zettelkasten">Zettelkasten</a><a href="https://github.com/krish-adi" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo-light.svg" alt="adithya krishnan" class="themedImage_ToTc themedImage--light_HNdA" style="height:24px"><img src="/img/logo-dark.svg" alt="adithya krishnan" class="themedImage_ToTc themedImage--dark_i4oU" style="height:24px"></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/zettelkasten/">Zettelkasten</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zettelkasten/python">Python Environments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zettelkasten/rheology">Rheology</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zettelkasten/machine-learning">Machine Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zettelkasten/pandas">Pandas</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zettelkasten/deep-learning">Deep Learning</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/zettelkasten/tutorials/">Tutorials</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zettelkasten/tutorials/greppo-introduction">Greppo introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zettelkasten/tutorials/gee-greppo">Google Earth Engine and Greppo</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Deep Learning</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="single-neuron">Single neuron<a href="#single-neuron" class="hash-link" aria-label="Direct link to Single neuron" title="Direct link to Single neuron">â€‹</a></h2><p>Is the fundamental component of a neural network. It is a Linear Unit:Â ğ‘¦=ğ‘¤ğ‘¥+ğ‘y=wx+b</p><p><img loading="lazy" src="https://i.imgur.com/mfOlDR6.png" alt="Diagram of a linear unit." class="img_ev3q"></p><p>The input isÂ <code>x</code>. Its connection to the neuron has aÂ <strong>weight</strong>Â which isÂ <code>w</code>. Whenever a value flows through a connection, you multiply the value by the connection&#x27;s weight. For the inputÂ <code>x</code>, what reaches the neuron isÂ <code>w * x</code>. A neural network &quot;learns&quot; by modifying its weights.</p><p>TheÂ <code>b</code>Â is a special kind of weight we call theÂ <strong>bias</strong>. The bias doesn&#x27;t have any input data associated with it; instead, we put aÂ <code>1</code>Â in the diagram so that the value that reaches the neuron is justÂ <code>b</code>Â (sinceÂ <code>1 * b = b</code>). The bias enables the neuron to modify the output independently of its inputs.</p><p>TheÂ <code>y</code>Â is the value the neuron ultimately outputs. To get the output, the neuron sums up all the values it receives through its connections. This neuron&#x27;s activation isÂ <code>y = w * x + b</code>, or as a formulaÂ ğ‘¦=ğ‘¤ğ‘¥+ğ‘y=wx+b.</p><p><strong>Multiple inputs</strong></p><p>We can just add more input connections to the neuron, one for each additional feature. To find the output, we would multiply each input to its connection weight and then add them all together.</p><p><img loading="lazy" src="https://i.imgur.com/vyXSnlZ.png" alt="Three input connections: x0, x1, and x2, along with the bias." class="img_ev3q"></p><p>The formula for this neuron would beÂ ğ‘¦=ğ‘¤0ğ‘¥0+ğ‘¤1ğ‘¥1+ğ‘¤2ğ‘¥2+ğ‘y=w0x0+w1x1+w2x2+b. A linear unit with two inputs will fit a plane, and a unit with more inputs than that will fit a hyperplane.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="linear-units-in-keras"><a href="https://www.kaggle.com/code/ryanholbrook/a-single-neuron#Linear-Units-in-Keras" target="_blank" rel="noopener noreferrer">Linear Units in Keras</a><a href="#linear-units-in-keras" class="hash-link" aria-label="Direct link to linear-units-in-keras" title="Direct link to linear-units-in-keras">â€‹</a></h2><p>Create a model in Keras throughÂ <code>keras.Sequential</code>, which creates a neural network as a stack ofÂ <em>layers</em>.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> keras</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> layers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create a network with 1 linear unit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">units</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input_shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With the first argument,Â <code>units</code>, we define how many outputs we want. In this case of one output we&#x27;ll useÂ <code>units=1</code>. With the second argument,Â <code>input_shape</code>, we tell Keras the dimensions of the inputs. SettingÂ <code>input_shape=[3]</code>Â ensures the model will accept three features as input. <code>input_shape</code>Â a Python list as the features are arranged by column, so we&#x27;ll always haveÂ <code>input_shape=[num_columns]</code>. The reason Keras uses a list here is to permit use of more complex datasets. Image data, for instance, might need three dimensions:Â <code>[height, width, channels]</code>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="deep-neural-network">Deep neural network<a href="#deep-neural-network" class="hash-link" aria-label="Direct link to Deep neural network" title="Direct link to Deep neural network">â€‹</a></h2><p><a href="https://www.kaggle.com/code/ryanholbrook/deep-neural-networks#Layers" target="_blank" rel="noopener noreferrer"><strong>Layers</strong></a></p><p>Neural networks typically organize their neurons intoÂ <strong>layers</strong>. When we collect together linear units having a common set of inputs we get aÂ <strong>dense</strong>Â layer.</p><p><img loading="lazy" src="https://i.imgur.com/2MA4iMV.png" alt="A stack of three circles in an input layer connected to two circles in a dense layer." class="img_ev3q"></p><p>A dense layer of two linear units receiving two inputs and a bias.</p><p>Each layer in a neural network performs some kind of relatively simple transformation. Through a deep stack of layers, a neural network can transform its inputs in more and more complex ways. In a well-trained neural network, each layer is a transformation getting us a little bit closer to a solution. A layer can be, essentially, any kind ofÂ <em>data transformation</em>. Many layers, like theÂ <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Conv2D" target="_blank" rel="noopener noreferrer">convolutional</a>Â andÂ <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/RNN" target="_blank" rel="noopener noreferrer">recurrent</a>Â layers, transform data through use of neurons and differ primarily in the pattern of connections they form. Others though are used forÂ <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Embedding" target="_blank" rel="noopener noreferrer">feature engineering</a>Â or justÂ <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Add" target="_blank" rel="noopener noreferrer">simple arithmetic</a>. <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers" target="_blank" rel="noopener noreferrer">The other layers to explore</a>!</p><p><a href="https://www.kaggle.com/code/ryanholbrook/deep-neural-networks#The-Activation-Function" target="_blank" rel="noopener noreferrer"><strong>Activation Function</strong></a></p><p>It turns out, however, that two dense layers with nothing in between are no better than a single dense layer by itself. Dense layers by themselves can never move us out of the world of lines and planes. What we need is somethingÂ <em>nonlinear</em>. What we need are activation functions.</p><p><img loading="lazy" src="https://i.imgur.com/OLSUEYT.png" class="img_ev3q"></p><p>Without activation functions, neural networks can only learn linear relationships. In order to fit curves, we&#x27;ll need to use activation functions.</p><p>AnÂ <strong>activation function</strong>Â is simply some function we apply to each of a layer&#x27;s outputs (itsÂ <em>activations</em>). The most common is theÂ <em>rectifier</em>Â functionÂ ğ‘šğ‘ğ‘¥(0,ğ‘¥)max(0,x).</p><p><img loading="lazy" src="https://i.imgur.com/aeIyAlF.png" alt="A graph of the rectifier function. The line y=x when x&gt;0 and y=0 when x&lt;0, making a &#x27;hinge&#x27; shape like &#x27;_/&#x27;." class="img_ev3q"></p><p>The rectifier function has a graph that&#x27;s a line with the negative part &quot;rectified&quot; to zero. Applying the function to the outputs of a neuron will put aÂ <em>bend</em>Â in the data, moving us away from simple lines.</p><p>When we attach the rectifier to a linear unit, we get aÂ <strong>rectified linear unit</strong>Â orÂ <strong>ReLU</strong>. (For this reason, it&#x27;s common to call the rectifier function the &quot;ReLU function&quot;.) Applying a ReLU activation to a linear unit means the output becomesÂ <code>max(0, w * x + b)</code>, which we might draw in a diagram like:</p><p><img loading="lazy" src="https://i.imgur.com/eFry7Yu.png" alt="Diagram of a single ReLU. Like a linear unit, but instead of a &#x27;+&#x27; symbol we now have a hinge &#x27;_/&#x27;." class="img_ev3q"></p><p>A rectified linear unit.</p><p><a href="https://www.kaggle.com/code/ryanholbrook/deep-neural-networks#Stacking-Dense-Layers" target="_blank" rel="noopener noreferrer"><strong>Stacking Dense Layers</strong></a></p><p>Stack layers to get complex data transformations.</p><p><img loading="lazy" src="https://i.imgur.com/Y5iwFQZ.png" alt="An input layer, two hidden layers, and a final linear layer." class="img_ev3q"></p><p>A stack of dense layers makes a &quot;fully-connected&quot; network.</p><p>The layers before the output layer are sometimes calledÂ <strong>hidden</strong>Â since we never see their outputs directly.</p><p>Now, notice that the final (output) layer is a linear unit (meaning, no activation function). That makes this network appropriate to a regression task, where we are trying to predict some arbitrary numeric value. Other tasks (like classification) might require an activation function on the output.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="building-sequential-modelshttpswwwkagglecomcoderyanholbrookdeep-neural-networksbuilding-sequential-models">Building Sequential Models(<a href="https://www.kaggle.com/code/ryanholbrook/deep-neural-networks#Building-Sequential-Models" target="_blank" rel="noopener noreferrer">https://www.kaggle.com/code/ryanholbrook/deep-neural-networks#Building-Sequential-Models</a>)<a href="#building-sequential-modelshttpswwwkagglecomcoderyanholbrookdeep-neural-networksbuilding-sequential-models" class="hash-link" aria-label="Direct link to building-sequential-modelshttpswwwkagglecomcoderyanholbrookdeep-neural-networksbuilding-sequential-models" title="Direct link to building-sequential-modelshttpswwwkagglecomcoderyanholbrookdeep-neural-networksbuilding-sequential-models">â€‹</a></h2><p>TheÂ <code>Sequential</code>Â model we&#x27;ve been using will connect together a list of layers in order from first to last: the first layer gets the input, the last layer produces the output. This creates the model in the figure above:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> keras</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> layers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># the hidden ReLU layers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">units</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input_shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">units</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># the linear output layer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">units</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="stochastic-gradient-descent">Stochastic gradient descent<a href="#stochastic-gradient-descent" class="hash-link" aria-label="Direct link to Stochastic gradient descent" title="Direct link to Stochastic gradient descent">â€‹</a></h2><p>We need two more things:</p><ul><li>A &quot;loss function&quot; that measures how good the network&#x27;s predictions are.</li><li>An &quot;optimizer&quot; that can tell the network how to change its weights.</li></ul><p><a href="https://www.kaggle.com/code/ryanholbrook/stochastic-gradient-descent#The-Loss-Function" target="_blank" rel="noopener noreferrer"><strong>The Loss Function</strong></a></p><p>Tell a networkÂ <em>what</em>Â problem to solve. This is the job of the loss function. TheÂ <strong>loss function</strong>Â measures the disparity between the the target&#x27;s true value and the value the model predicts.</p><p>A common loss function for regression problems is theÂ <strong>mean absolute error</strong>Â orÂ <strong>MAE</strong>. For each predictionÂ <code>y_pred</code>, MAE measures the disparity from the true targetÂ <code>y_true</code>Â by an absolute differenceÂ <code>abs(y_true - y_pred)</code>.</p><p>The total MAE loss on a dataset is the mean of all these absolute differences. The mean absolute error is the average length between the fitted curve and the data points.</p><p><img loading="lazy" src="https://i.imgur.com/VDcvkZN.png" alt="A graph depicting error bars from data points to the fitted line.." class="img_ev3q"></p><p>Besides MAE, other loss functions you might see for regression problems are the mean-squared error (MSE) or the Huber loss (both available in Keras).</p><p>During training, the model will use the loss function as a guide for finding the correct values of its weights (lower loss is better). In other words, the loss function tells the network its objective.</p><p><a href="https://www.kaggle.com/code/ryanholbrook/stochastic-gradient-descent#The-Optimizer---Stochastic-Gradient-Descent" target="_blank" rel="noopener noreferrer"><strong>The Optimizer - Stochastic Gradient Descent</strong></a></p><p><em>how</em>Â to solve it. This is the job of theÂ <strong>optimizer</strong>. The optimizer is an algorithm that adjusts the weights to minimize the loss. Virtually all of the optimization algorithms used in deep learning belong to a family calledÂ <strong>stochastic gradient descent</strong>. They are iterative algorithms that train a network in steps. OneÂ <strong>step</strong>Â of training goes like this:</p><ol><li>Sample some training data and run it through the network to make predictions.</li><li>Measure the loss between the predictions and the true values.</li><li>Finally, adjust the weights in a direction that makes the loss smaller.</li></ol><p>Then just do this over and over until the loss is as small as you like (or until it won&#x27;t decrease any further.)</p><p><img loading="lazy" src="https://i.imgur.com/rFI1tIk.gif" alt="Fitting a line batch by batch. The loss decreases and the weights approach their true values." class="img_ev3q"></p><p>Training a neural network with Stochastic Gradient Descent.</p><p>Each iteration&#x27;s sample of training data is called aÂ <strong>minibatch</strong>Â (or often just &quot;batch&quot;), while a complete round of the training data is called anÂ <strong>epoch</strong>. The number of epochs you train for is how many times the network will see each training example.</p><p><a href="https://www.kaggle.com/code/ryanholbrook/stochastic-gradient-descent#Learning-Rate-and-Batch-Size" target="_blank" rel="noopener noreferrer"><strong>Learning Rate and Batch Size</strong></a></p><p>The size of these shifts is determined by theÂ <strong>learning rate</strong>. A smaller learning rate means the network needs to see more minibatches before its weights converge to their best values.</p><p>The learning rate and the size of the minibatches are the two parameters that have the largest effect on how the SGD training proceeds. Their interaction is often subtle and the right choice for these parameters isn&#x27;t always obvious.</p><p>It won&#x27;t be necessary to do an extensive hyperparameter search to get satisfactory results.Â <strong>Adam</strong>Â is an SGD algorithm that has an adaptive learning rate that makes it suitable for most problems without any parameter tuning (it is &quot;self tuning&quot;, in a sense). Adam is a great general-purpose optimizer.</p><p><a href="https://www.kaggle.com/code/ryanholbrook/stochastic-gradient-descent#Adding-the-Loss-and-Optimizer" target="_blank" rel="noopener noreferrer"><strong>Adding the Loss and Optimizer</strong></a></p><p>After defining a model, you can add a loss function and optimizer with the model&#x27;sÂ <code>compile</code>Â method:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">model.compile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    optimizer=&quot;adam&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loss=&quot;mae&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Notice that we are able to specify the loss and optimizer with just a string. You can also access these directly through the Keras API -- if you wanted to tune parameters, for instance.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="example---red-wine-quality">Example - Red Wine Quality<a href="#example---red-wine-quality" class="hash-link" aria-label="Direct link to Example - Red Wine Quality" title="Direct link to Example - Red Wine Quality">â€‹</a></h2><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> IPython</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">display </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> display</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">red_wine </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;../input/dl-course-data/red-wine.csv&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create training and validation splits</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> red_wine</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">frac</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> random_state</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_valid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> red_wine</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">display</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Scale to [0, 1]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">min_ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_train </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> min_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max_ </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> min_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_valid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_valid </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> min_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max_ </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> min_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Split features and target</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;quality&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_valid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_valid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;quality&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y_train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;quality&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y_valid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_valid</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;quality&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>fixed acidity</th><th>volatile acidity</th><th>citric acid</th><th>residual sugar</th><th>chlorides</th><th>free sulfur dioxide</th><th>total sulfur dioxide</th><th>density</th><th>pH</th><th>sulphates</th><th>alcohol</th><th>quality</th><th></th></tr></thead><tbody><tr><td>1109</td><td>10.8</td><td>0.470</td><td>0.43</td><td>2.10</td><td>0.171</td><td>27.0</td><td>66.0</td><td>0.99820</td><td>3.17</td><td>0.76</td><td>10.8</td><td>6</td></tr><tr><td>1032</td><td>8.1</td><td>0.820</td><td>0.00</td><td>4.10</td><td>0.095</td><td>5.0</td><td>14.0</td><td>0.99854</td><td>3.36</td><td>0.53</td><td>9.6</td><td>5</td></tr><tr><td>1002</td><td>9.1</td><td>0.290</td><td>0.33</td><td>2.05</td><td>0.063</td><td>13.0</td><td>27.0</td><td>0.99516</td><td>3.26</td><td>0.84</td><td>11.7</td><td>7</td></tr><tr><td>487</td><td>10.2</td><td>0.645</td><td>0.36</td><td>1.80</td><td>0.053</td><td>5.0</td><td>14.0</td><td>0.99820</td><td>3.17</td><td>0.42</td><td>10.0</td><td>6</td></tr></tbody></table><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> keras</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> layers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">512</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input_shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">512</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">512</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">compile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    optimizer</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;adam&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loss</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;mae&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">history </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    X_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    validation_data</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_valid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_valid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    batch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    epochs</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>TheÂ <code>fit</code>Â method in fact keeps a record of the loss produced during training in aÂ <code>History</code>Â object. We&#x27;ll convert the data to a Pandas dataframe, which makes the plotting easy.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># convert the training history to a dataframe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history_df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">history</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">history</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># use Pandas native plot method</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history_df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;loss&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://www.kaggleusercontent.com/kf/86258816/eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..uNkhJtFK7RwmG9pSoAjnhA.-qzDMWcGxPkmaRklGHlD8pIdeDQBjbuslPDR-xw_uC2YzIsztW0VPQDI137Hz91VJBvuMfSOiz9OTRhdw1Ds5LwFF9lzSNPWM6UDtPWpmw5Ja1-28fgaid2GlSeC2i8M9fgigBQK08OfoDcG_GJQexDWUKhVTS4mcpXYApUNE0VsZBotIVY7U2pw36z4XS_3JBMFwzsyyXiwHJWaWpSDVoZd-Yt2D6CYt727zDb6EIF9NEhMT1L66TSYMgJWzDHlZLLp1bVmkNHWgLeqt352bKoeW_8upzRcWky6eMXfz5GBUyAzCxjhwsKgNLn1Fv0lVu_QSBwL1kZz7_ZfcUmJHDLVfZI6WfkSfpV6MHbtHgRNwg7EcUdo_C2_Fs_Ob4HzyzZB6uYI-Xg-kR1IHd0wK0Ii0XFiazi5OaQn4TFiLnGqCJBIRkXGe-gaMtFX4-wjEdQkzA1RwCsofos_IAXLt_eaO8-PnudFc3wfX9tVKxn6Il-0gQ8VE05NhbKhZQMPDqKjl4K774qFUutojGa0VW9uI-XhYPcv8FufeIzhdObX8Oye1U65hd18nqzRWdpylOMvipb1ZvvGrxwfienzko-86WDVSXrmcRMIEhhRLE2A8jFVdxvOa3u83Bmz7dyzmh_Bg9uT_-yfwvcc5QBBnCqH40Qk9hq_KHvxczLV3cU.Ovdjz8Kjs76XS7FAWl8AUA/__results___files/__results___12_0.png" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="overfitting-and-underfitting">Overfitting and Underfitting<a href="#overfitting-and-underfitting" class="hash-link" aria-label="Direct link to Overfitting and Underfitting" title="Direct link to Overfitting and Underfitting">â€‹</a></h2><p><a href="https://www.kaggle.com/code/ryanholbrook/overfitting-and-underfitting#Interpreting-the-Learning-Curves" target="_blank" rel="noopener noreferrer"><strong>Interpreting the Learning Curves</strong></a></p><p>You might think about the information in the training data as being of two kinds:Â <em>signal</em>Â andÂ <em>noise</em>. The signal is the part that generalizes, the part that can help our model make predictions from new data. The noise is that part that isÂ <em>only</em>Â true of the training data; the noise is all of the random fluctuation that comes from data in the real-world or all of the incidental, non-informative patterns that can&#x27;t actually help the model make predictions. The noise is the part might look useful but really isn&#x27;t.</p><p>We train a model by choosing weights or parameters that minimize the loss on a training set. You might know, however, that to accurately assess a model&#x27;s performance, we need to evaluate it on a new set of data, theÂ <em>validation</em>Â data. (You could see our lesson onÂ <a href="https://www.kaggle.com/dansbecker/model-validation" target="_blank" rel="noopener noreferrer">model validation</a>Â inÂ <em>Introduction to Machine Learning</em>Â for a review.)</p><p>When we train a model we&#x27;ve been plotting the loss on the training set epoch by epoch. To this we&#x27;ll add a plot the validation data too. These plots we call theÂ <strong>learning curves</strong>. To train deep learning models effectively, we need to be able to interpret them.</p><p><img loading="lazy" src="https://i.imgur.com/tHiVFnM.png" alt="A graph of training and validation loss." class="img_ev3q"></p><p>The validation loss gives an estimate of the expected error on unseen data.</p><p>Now, the training loss will go down either when the model learns signal or when it learns noise. But the validation loss will go down only when the model learns signal. (Whatever noise the model learned from the training set won&#x27;t generalize to new data.) So, when a model learns signal both curves go down, but when it learns noise aÂ <em>gap</em>Â is created in the curves. The size of the gap tells you how much noise the model has learned.</p><p>Ideally, we would create models that learn all of the signal and none of the noise. This will practically never happen. Instead we make a trade. We can get the model to learn more signal at the cost of learning more noise. So long as the trade is in our favor, the validation loss will continue to decrease. After a certain point, however, the trade can turn against us, the cost exceeds the benefit, and the validation loss begins to rise.</p><p><img loading="lazy" src="https://i.imgur.com/eUF6mfo.png" alt="Two graphs. On the left, a line through a few data points with the true fit a parabola. On the right, a curve running through each datapoint with the true fit a parabola." class="img_ev3q"></p><p>Underfitting and overfitting.</p><p>This trade-off indicates that there can be two problems that occur when training a model: not enough signal or too much noise.Â <strong>Underfitting</strong>Â the training set is when the loss is not as low as it could be because the model hasn&#x27;t learned enoughÂ <em>signal</em>.Â <strong>Overfitting</strong>Â the training set is when the loss is not as low as it could be because the model learned too muchÂ <em>noise</em>. The trick to training deep learning models is finding the best balance between the two.</p><p>We&#x27;ll look at a couple ways of getting more signal out of the training data while reducing the amount of noise.</p><p><a href="https://www.kaggle.com/code/ryanholbrook/overfitting-and-underfitting#Capacity" target="_blank" rel="noopener noreferrer"><strong>Capacity</strong></a></p><p>A model&#x27;sÂ <strong>capacity</strong>Â refers to the size and complexity of the patterns it is able to learn. For neural networks, this will largely be determined by how many neurons it has and how they are connected together. If it appears that your network is underfitting the data, you should try increasing its capacity.</p><p>You can increase the capacity of a network either by making itÂ <em>wider</em>Â (more units to existing layers) or by making itÂ <em>deeper</em>Â (adding more layers). Wider networks have an easier time learning more linear relationships, while deeper networks prefer more nonlinear ones. Which is better just depends on the dataset.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">model = keras.Sequential([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers.Dense(16, activation=&#x27;relu&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers.Dense(1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wider = keras.Sequential([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers.Dense(32, activation=&#x27;relu&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers.Dense(1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deeper = keras.Sequential([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers.Dense(16, activation=&#x27;relu&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers.Dense(16, activation=&#x27;relu&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers.Dense(1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://www.kaggle.com/code/ryanholbrook/overfitting-and-underfitting#Early-Stopping" target="_blank" rel="noopener noreferrer"><strong>Early Stopping</strong></a></p><p>We mentioned that when a model is too eagerly learning noise, the validation loss may start to increase during training. To prevent this, we can simply stop the training whenever it seems the validation loss isn&#x27;t decreasing anymore. Interrupting the training this way is calledÂ <strong>early stopping</strong>.</p><p><img loading="lazy" src="https://i.imgur.com/eP0gppr.png" alt="A graph of the learning curves with early stopping at the minimum validation loss, underfitting to the left of it and overfitting to the right." class="img_ev3q"></p><p>We keep the model where the validation loss is at a minimum.</p><p>Once we detect that the validation loss is starting to rise again, we can reset the weights back to where the minimum occured. This ensures that the model won&#x27;t continue to learn noise and overfit the data.</p><p>Training with early stopping also means we&#x27;re in less danger of stopping the training too early, before the network has finished learning signal. So besides preventing overfitting from training too long, early stopping can also preventÂ <em>underfitting</em>Â from not training long enough. Just set your training epochs to some large number (more than you&#x27;ll need), and early stopping will take care of the rest.</p><p><a href="https://www.kaggle.com/code/ryanholbrook/overfitting-and-underfitting#Adding-Early-Stopping" target="_blank" rel="noopener noreferrer"><strong>Adding Early Stopping</strong></a></p><p>In Keras, we include early stopping in our training through a callback. AÂ <strong>callback</strong>Â is just a function you want run every so often while the network trains. The early stopping callback will run after every epoch. (Keras hasÂ <a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks" target="_blank" rel="noopener noreferrer">a variety of useful callbacks</a>Â pre-defined, but you canÂ <a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/LambdaCallback" target="_blank" rel="noopener noreferrer">define your own</a>, too.)</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">callbacks </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> EarlyStopping</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">early_stopping </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> EarlyStopping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    min_delta</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.001</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># minimium amount of change to count as an improvement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    patience</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># how many epochs to wait before stopping</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restore_best_weights</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>These parameters say: &quot;If there hasn&#x27;t been at least an improvement of 0.001 in the validation loss over the previous 20 epochs, then stop the training and keep the best model you found.&quot; It can sometimes be hard to tell if the validation loss is rising due to overfitting or just due to random batch variation. The parameters allow us to set some allowances around when to stop.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="example---continue">Example - Continue<a href="#example---continue" class="hash-link" aria-label="Direct link to Example - Continue" title="Direct link to Example - Continue">â€‹</a></h2><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> keras</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> layers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> callbacks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">early_stopping </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> callbacks</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EarlyStopping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    min_delta</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.001</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># minimium amount of change to count as an improvement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    patience</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># how many epochs to wait before stopping</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restore_best_weights</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">512</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input_shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">512</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">512</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">compile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    optimizer</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;adam&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loss</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;mae&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">history </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    X_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    validation_data</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_valid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_valid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    batch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    epochs</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">500</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    callbacks</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">early_stopping</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># put your callbacks in a list</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    verbose</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># turn off training log</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history_df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">history</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">history</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history_df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;loss&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;val_loss&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Minimum validation loss: {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">history_df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;val_loss&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Minimum validation loss: 0.09154561161994934</p><p><img loading="lazy" src="https://www.kaggleusercontent.com/kf/86258812/eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..Yf3L9fIXJzuVdnPZs53AxQ.4jHZo86oA7fcdn0iNS2xBx-4QqmXOjAOSYChFEyxJrB0NftKLwuPUNq7wBnuJ2WFbalK-xfG6EQsg3Jk0x599gyAXHA5TFKH7Mg_oNE-XivLwAml-wY3Ey-HjlResmGFY3KK2-NMvpy1zQ0xPXEUnWVTwaMrD6i3dDyHh-9tbtfx_HcP5o5K5tDDCDax2xyKLSYMAgb_bg6VxddhHZOCS81JV22kMbYdAljsSIEBoxO0z5SgNgNF6rQJ-4UTMBYPa6kNa-Lb5d-5zvTF80WXTTaGTkpl6J4zGTvyH-KI_upofdk5__pvPPgIKFwtv3AjOYX6jZccI_oRlcIeTrnAkeCu1HVJMG31zOK_iOKJsFbwcTbbwk_VqT21N1tLeL1D7ujzeWsby3dhtG97IVkh4tPMzXAov8NEZzN-6YQ1cxMj9lvnV3CcAxgg0UrCApwzGuSVNHi2tJzv8doHcDr0C01ddNYMqYMWDDbF6Me2BEJ_2Nnxy9Zi6S2MyCo1LRndiyVSF1vUt554Dsi594vOc6l2CZr7Wf0xd55A62drY4htsWjMX86VbA9a0bjpl3Ag9Y-KKO1WluOgORkR-7A9DQ6gzlDiRYhpKp8GLlkjl-UW_h1OVQCFQPeQbS-Nvk1C04W7IW4V_COWECx_OJUS7V2JrVW3XKuAOJmntDr-Zo4.wTh7qvGZUT0_sd4VdMmNUg/__results___files/__results___7_2.png" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="dropout-and-batch-normalization-some-special-layer-examples">Dropout and Batch Normalization (some special layer examples)<a href="#dropout-and-batch-normalization-some-special-layer-examples" class="hash-link" aria-label="Direct link to Dropout and Batch Normalization (some special layer examples)" title="Direct link to Dropout and Batch Normalization (some special layer examples)">â€‹</a></h2><p><a href="https://www.kaggle.com/code/ryanholbrook/dropout-and-batch-normalization#Dropout" target="_blank" rel="noopener noreferrer"><strong>Dropout</strong></a></p><p>The first of these is the &quot;dropout layer&quot;, which can help correct overfitting.</p><p>Overfitting is caused by the network learning spurious patterns in the training data. To recognize these spurious patterns a network will often rely on very a specific combinations of weight, a kind of &quot;conspiracy&quot; of weights. Being so specific, they tend to be fragile: remove one and the conspiracy falls apart.</p><p>This is the idea behindÂ <strong>dropout</strong>. To break up these conspiracies, we randomlyÂ <em>drop out</em>Â some fraction of a layer&#x27;s input units every step of training, making it much harder for the network to learn those spurious patterns in the training data. Instead, it has to search for broad, general patterns, whose weight patterns tend to be more robust.</p><p><img loading="lazy" src="https://i.imgur.com/a86utxY.gif" alt="An animation of a network cycling through various random dropout configurations." class="img_ev3q"></p><p>Here, 50% dropout has been added between the two hidden layers.</p><p>You could also think about dropout as creating a kind ofÂ <em>ensemble</em>Â of networks. The predictions will no longer be made by one big network, but instead by a committee of smaller networks. Individuals in the committee tend to make different kinds of mistakes, but be right at the same time, making the committee as a whole better than any individual. (If you&#x27;re familiar with random forests as an ensemble of decision trees, it&#x27;s the same idea.)</p><p><a href="https://www.kaggle.com/code/ryanholbrook/dropout-and-batch-normalization#Adding-Dropout" target="_blank" rel="noopener noreferrer"><em>Adding Dropout</em></a></p><p>In Keras, the dropout rate argumentÂ <code>rate</code>Â defines what percentage of the input units to shut off. Put theÂ <code>Dropout</code>Â layer just before the layer you want the dropout applied to:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dropout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rate</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># apply 30% dropout to the next layer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Batch Normalization<a href="https://www.kaggle.com/code/ryanholbrook/dropout-and-batch-normalization#Batch-Normalization" target="_blank" rel="noopener noreferrer"></a></h1><p>Next layer performs &quot;batch normalization&quot; (or &quot;batchnorm&quot;), which can help correct training that is slow or unstable.</p><p>With neural networks, it&#x27;s generally a good idea to put all of your data on a common scale, perhaps with something like scikit-learn&#x27;sÂ <a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html" target="_blank" rel="noopener noreferrer">StandardScaler</a>Â orÂ <a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html" target="_blank" rel="noopener noreferrer">MinMaxScaler</a>. The reason is that SGD will shift the network weights in proportion to how large an activation the data produces. Features that tend to produce activations of very different sizes can make for unstable training behavior.</p><p>Now, if it&#x27;s good to normalize the data before it goes into the network, maybe also normalizing inside the network would be better! In fact, we have a special kind of layer that can do this, theÂ <strong>batch normalization layer</strong>. A batch normalization layer looks at each batch as it comes in, first normalizing the batch with its own mean and standard deviation, and then also putting the data on a new scale with two trainable rescaling parameters. Batchnorm, in effect, performs a kind of coordinated rescaling of its inputs.</p><p>Most often, batchnorm is added as an aid to the optimization process (though it can sometimes also help prediction performance). Models with batchnorm tend to need fewer epochs to complete training. Moreover, batchnorm can also fix various problems that can cause the training to get &quot;stuck&quot;. Consider adding batch normalization to your models, especially if you&#x27;re having trouble during training.</p><p><a href="https://www.kaggle.com/code/ryanholbrook/dropout-and-batch-normalization#Adding-Batch-Normalization" target="_blank" rel="noopener noreferrer"><em>Adding Batch Normalization</em></a></p><p>It seems that batch normalization can be used at almost any point in a network. You can put it after a layer...</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BatchNormalization</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>... or between a layer and its activation function:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BatchNormalization</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Activation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And if you add it as the first layer of your network it can act as a kind of adaptive preprocessor, standing in for something like Sci-Kit Learn&#x27;sÂ <code>StandardScaler</code>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="example---using-dropout-and-batch-normalization"><a href="https://www.kaggle.com/code/ryanholbrook/dropout-and-batch-normalization#Example---Using-Dropout-and-Batch-Normalization" target="_blank" rel="noopener noreferrer">Example - Using Dropout and Batch Normalization</a><a href="#example---using-dropout-and-batch-normalization" class="hash-link" aria-label="Direct link to example---using-dropout-and-batch-normalization" title="Direct link to example---using-dropout-and-batch-normalization">â€‹</a></h2><p>Let&#x27;s continue developing theÂ <em>Red Wine</em>Â model. Now we&#x27;ll increase the capacity even more, but add dropout to control overfitting and batch normalization to speed up optimization. This time, we&#x27;ll also leave off standardizing the data, to demonstrate how batch normalization can stabalize the training.</p><p>When adding dropout, you may need to increase the number of units in yourÂ <code>Dense</code>Â layers.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> keras</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> layers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input_shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dropout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BatchNormalization</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dropout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BatchNormalization</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dropout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BatchNormalization</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">compile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    optimizer</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;adam&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loss</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;mae&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    X_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    validation_data</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_valid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_valid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    batch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    epochs</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    verbose</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Show the learning curves</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history_df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">history</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">history</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history_df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;loss&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;val_loss&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://www.kaggleusercontent.com/kf/86258821/eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..c5gv9goDkeSW7c4XwutyfQ.kIrAQmrreEoD8OaYa-MfnBgmcHPIkSif21Sjc0mF-lzVDACo9TxxBGlrdApKSj_v-YkfGqquzf522VUuslYc3xIdkigQb6F5UbEYHXv0iUzFwnpnWTzRJMPbzuotVAU5zYMVDb_BOEEQIjD46lG86LyVGSkXmZcePYdmQJjP8DFCnAxS5cc0sk8bjy0n7Uduc-sw-pt8B6puEuW6nIAS_0vdfCNhLLG95OtpOBR1O0Ro4BqxbWI7AytdRqlFTR_mRUIaq1sKXGzNn29GdWqvYtDfNGUnj5Cb0yZThkZaALam-MRS4bFtPmlyPbgEUPs-cs2WUjWVXQHTZ--wvjU5eo4ez6z8rmWiFSxUSnpzWKffGVAYNrt_F7LOQVI3TkV19uxuZDz9QVAVgZtQfD8DoKKdhs-J6rSfn4TXNK5ApsybxRFv841_lPqe7RcbtAKflo4VqfE8UgspafPn1PCRC0pOSEFrYNvXP4whTWLuS-pcpicIASX_F1G3O4EMhfhREDsxLxxKhnBcoCE2oLas0YCTkAzQLsGcH73vsBXJBwBvWx8LncYwic3VqaR8f-fp5sI7D8T_zbPUGSz2WIW_mo8y6FtAJ4-MmDNu-WezUKZqMLpLxGWcdmFlwFK4wTDpcw-412chYhtBmF94VSMIrlkJIKpEVdcKJbJHyzqR8EjiMtrgnaqdGHhOQSfdRbO1.GRvj0MPaJ4hkvti3SMwe9w/__results___files/__results___5_1.png" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="binary-classification">Binary classification<a href="#binary-classification" class="hash-link" aria-label="Direct link to Binary classification" title="Direct link to Binary classification">â€‹</a></h2><p>Classification into one of two classes is a common machine learning problem. You might want to predict whether or not a customer is likely to make a purchase, whether or not a credit card transaction was fraudulent, whether deep space signals show evidence of a new planet, or a medical test evidence of a disease. These are allÂ <strong>binary classification</strong>Â problems.</p><p>In your raw data, the classes might be represented by strings likeÂ <code>&quot;Yes&quot;</code>Â andÂ <code>&quot;No&quot;</code>, orÂ <code>&quot;Dog&quot;</code>Â andÂ <code>&quot;Cat&quot;</code>. Before using this data we&#x27;ll assign aÂ <strong>class label</strong>: one class will beÂ <code>0</code>Â and the other will beÂ <code>1</code>. Assigning numeric labels puts the data in a form a neural network can use.</p><p><a href="https://www.kaggle.com/code/ryanholbrook/binary-classification#Accuracy-and-Cross-Entropy" target="_blank" rel="noopener noreferrer"><strong>Accuracy and Cross-Entropy</strong></a></p><p><strong>Accuracy</strong>Â is one of the many metrics in use for measuring success on a classification problem. Accuracy is the ratio of correct predictions to total predictions:Â <code>accuracy = number_correct / total</code>. A model that always predicted correctly would have an accuracy score ofÂ <code>1.0</code>. All else being equal, accuracy is a reasonable metric to use whenever the classes in the dataset occur with about the same frequency.</p><p>The problem with accuracy (and most other classification metrics) is that it can&#x27;t be used as a loss function. SGD needs a loss function that changes smoothly, but accuracy, being a ratio of counts, changes in &quot;jumps&quot;. So, we have to choose a substitute to act as the loss function. This substitute is theÂ <em>cross-entropy</em>Â function.</p><p>Now, recall that the loss function defines theÂ <em>objective</em>Â of the network during training. With regression, our goal was to minimize the distance between the expected outcome and the predicted outcome. We chose MAE to measure this distance.</p><p>For classification, what we want instead is a distance betweenÂ <em>probabilities</em>, and this is what cross-entropy provides.Â <strong>Cross-entropy</strong>Â is a sort of measure for the distance from one probability distribution to another.</p><p><img loading="lazy" src="https://i.imgur.com/DwVV9bR.png" alt="Graphs of accuracy and cross-entropy." class="img_ev3q"></p><p>Cross-entropy penalizes incorrect probability predictions.</p><p>The idea is that we want our network to predict the correct class with probabilityÂ <code>1.0</code>. The further away the predicted probability is fromÂ <code>1.0</code>, the greater will be the cross-entropy loss.</p><p>Use cross-entropy for a classification loss; other metrics you might care about (like accuracy) will tend to improve along with it.</p><p><a href="https://www.kaggle.com/code/ryanholbrook/binary-classification#Making-Probabilities-with-the-Sigmoid-Function" target="_blank" rel="noopener noreferrer"><strong>Making Probabilities with the Sigmoid Function</strong></a></p><p>The cross-entropy and accuracy functions both require probabilities as inputs, meaning, numbers from 0 to 1. To covert the real-valued outputs produced by a dense layer into probabilities, we attach a new kind of activation function, theÂ <strong>sigmoid activation</strong>.</p><p><img loading="lazy" src="https://i.imgur.com/FYbRvJo.png" alt="The sigmoid graph is an &#x27;S&#x27; shape with horizontal asymptotes at 0 to the left and 1 to the right." class="img_ev3q"></p><p>The sigmoid function maps real numbers into the intervalÂ <!-- -->[0,1][0,1]<!-- -->.</p><p>To get the final class prediction, we define aÂ <em>threshold</em>Â probability. Typically this will be 0.5, so that rounding will give us the correct class: below 0.5 means the class with label 0 and 0.5 or above means the class with label 1. A 0.5 threshold is what Keras uses by default with itsÂ <a href="https://www.tensorflow.org/api_docs/python/tf/keras/metrics/BinaryAccuracy" target="_blank" rel="noopener noreferrer">accuracy metric</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="example---binary-classification"><a href="https://www.kaggle.com/code/ryanholbrook/binary-classification#Example---Binary-Classification" target="_blank" rel="noopener noreferrer">Example - Binary Classification</a><a href="#example---binary-classification" class="hash-link" aria-label="Direct link to example---binary-classification" title="Direct link to example---binary-classification">â€‹</a></h2><p>TheÂ <a href="https://archive.ics.uci.edu/ml/datasets/Ionosphere" target="_blank" rel="noopener noreferrer">Ionosphere</a>Â dataset contains features obtained from radar signals focused on the ionosphere layer of the Earth&#x27;s atmosphere. The task is to determine whether the signal shows the presence of some object, or just empty air.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> IPython</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">display </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> display</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ion </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;../input/dl-course-data/ion.csv&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index_col</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">display</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ion</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ion</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Class&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Class&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;good&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;bad&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">frac</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> random_state</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_valid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">min_ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_train </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> min_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max_ </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> min_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_valid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_valid </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> min_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max_ </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> min_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dropna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inplace</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># drop the empty feature in column 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_valid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dropna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inplace</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Class&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_valid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_valid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Class&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y_train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Class&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y_valid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_valid</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Class&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th></th><th>V1</th><th>V2</th><th>V3</th><th>V4</th><th>V5</th><th>V6</th><th>V7</th><th>V8</th><th>V9</th><th>V10</th><th>...</th><th>V26</th><th>V27</th><th>V28</th><th>V29</th><th>V30</th><th>V31</th><th>V32</th><th>V33</th><th>V34</th><th>Class</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>0</td><td>0.99539</td><td>-0.05889</td><td>0.85243</td><td>0.02306</td><td>0.83398</td><td>-0.37708</td><td>1.00000</td><td>0.03760</td><td>...</td><td>-0.51171</td><td>0.41078</td><td>-0.46168</td><td>0.21266</td><td>-0.34090</td><td>0.42267</td><td>-0.54487</td><td>0.18641</td><td>-0.45300</td><td>good</td></tr><tr><td>2</td><td>1</td><td>0</td><td>1.00000</td><td>-0.18829</td><td>0.93035</td><td>-0.36156</td><td>-0.10868</td><td>-0.93597</td><td>1.00000</td><td>-0.04549</td><td>...</td><td>-0.26569</td><td>-0.20468</td><td>-0.18401</td><td>-0.19040</td><td>-0.11593</td><td>-0.16626</td><td>-0.06288</td><td>-0.13738</td><td>-0.02447</td><td>bad</td></tr><tr><td>3</td><td>1</td><td>0</td><td>1.00000</td><td>-0.03365</td><td>1.00000</td><td>0.00485</td><td>1.00000</td><td>-0.12062</td><td>0.88965</td><td>0.01198</td><td>...</td><td>-0.40220</td><td>0.58984</td><td>-0.22145</td><td>0.43100</td><td>-0.17365</td><td>0.60436</td><td>-0.24180</td><td>0.56045</td><td>-0.38238</td><td>good</td></tr><tr><td>4</td><td>1</td><td>0</td><td>1.00000</td><td>-0.45161</td><td>1.00000</td><td>1.00000</td><td>0.71216</td><td>-1.00000</td><td>0.00000</td><td>0.00000</td><td>...</td><td>0.90695</td><td>0.51613</td><td>1.00000</td><td>1.00000</td><td>-0.20099</td><td>0.25682</td><td>1.00000</td><td>-0.32382</td><td>1.00000</td><td>bad</td></tr><tr><td>5</td><td>1</td><td>0</td><td>1.00000</td><td>-0.02401</td><td>0.94140</td><td>0.06531</td><td>0.92106</td><td>-0.23255</td><td>0.77152</td><td>-0.16399</td><td>...</td><td>-0.65158</td><td>0.13290</td><td>-0.53206</td><td>0.02431</td><td>-0.62197</td><td>-0.05707</td><td>-0.59573</td><td>-0.04608</td><td>-0.65697</td><td>good</td></tr></tbody></table><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> keras</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> layers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input_shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">33</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;relu&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;sigmoid&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">compile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    optimizer</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;adam&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loss</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;binary_crossentropy&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metrics</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;binary_accuracy&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">early_stopping </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">callbacks</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EarlyStopping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    patience</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    min_delta</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.001</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restore_best_weights</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    X_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    validation_data</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_valid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_valid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    batch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">512</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    epochs</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    callbacks</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">early_stopping</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    verbose</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># hide the output because we have so many epochs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history_df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">history</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">history</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Start the plot at epoch 5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history_df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;loss&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;val_loss&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history_df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;binary_accuracy&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;val_binary_accuracy&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Best Validation Loss: {:0.4f}&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain">\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;\nBest Validation Accuracy: {:0.4f}&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">history_df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;val_loss&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              history_df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;val_binary_accuracy&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Best Validation Loss</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5482</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Best Validation Accuracy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.7619</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">www</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">kaggleusercontent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">kf</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">86258839</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Se</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">_r</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">QoxyaDTJOBH2APQ</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UmftqZcEl83h8ssskNmVEBr1UUep</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">gCPWecHInnFcOt7vWPh0bfuXWvSeXW23V6qgYes</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">4e4Ql2C1vlKQMllqm_4PwXePGIoWDGRIcBYmkOW6_pefWLfJWfzguyjY2</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">PvOcYLYNIfmzXhIBWR6ImCLOkW</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">8Dsgoa0TQWoWuaNNCIG1UPXnRecm0PXfe_JMO</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ahF0txSu_bDX863gjy1dONNp2D_LQZfBqyrujFLgPYGarH54X0GGY0wkFy2hdvgxtGD66QzyP_gLHT90hfQDw9jb_5ZXfVSSGI4Kg2QhRenh8zODqJUJxvDkLBPH9yshYkzDbjSaxjXMjCcceqBrx2adWqigAUSmjmrAV9f4cR_aifm_pP5XbHQo56EiQJ4CLi9xFXZPu</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">wy5m1paqU7qeYH95qfv59UBRCdnwfypHIUDV</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">JM628FJcEkspBgz_qmr</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">MF7ubxY0c7VUWeIGQCb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">1_Dtdou0bxN4tn7UPMTEZidpVzheuOwd6bIeOqUZBL10pTpM1kZaZmDWizHF77ce3QQTZ7ni0Cem</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">OQV7bEqhYI0GfSr8lKLrYFrW7O8cavAqPGx3lcd5uX4AZsLOAOy8GT0LGpEjhfLPuhZoNfJh1Dfc_jRkKP21O2TyveR_FeKviS</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">OeTgAFi7Gr</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">oSeLJy4M8C4DxvqOG</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">DCMf4k</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b7jlWGViHMw7LqnNx2t5AA</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">__results___files</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">__results___9_1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">png</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">www</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">kaggleusercontent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">kf</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">86258839</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Se</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">_r</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">QoxyaDTJOBH2APQ</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UmftqZcEl83h8ssskNmVEBr1UUep</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">gCPWecHInnFcOt7vWPh0bfuXWvSeXW23V6qgYes</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">4e4Ql2C1vlKQMllqm_4PwXePGIoWDGRIcBYmkOW6_pefWLfJWfzguyjY2</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">PvOcYLYNIfmzXhIBWR6ImCLOkW</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">8Dsgoa0TQWoWuaNNCIG1UPXnRecm0PXfe_JMO</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ahF0txSu_bDX863gjy1dONNp2D_LQZfBqyrujFLgPYGarH54X0GGY0wkFy2hdvgxtGD66QzyP_gLHT90hfQDw9jb_5ZXfVSSGI4Kg2QhRenh8zODqJUJxvDkLBPH9yshYkzDbjSaxjXMjCcceqBrx2adWqigAUSmjmrAV9f4cR_aifm_pP5XbHQo56EiQJ4CLi9xFXZPu</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">wy5m1paqU7qeYH95qfv59UBRCdnwfypHIUDV</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">JM628FJcEkspBgz_qmr</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">MF7ubxY0c7VUWeIGQCb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">1_Dtdou0bxN4tn7UPMTEZidpVzheuOwd6bIeOqUZBL10pTpM1kZaZmDWizHF77ce3QQTZ7ni0Cem</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">OQV7bEqhYI0GfSr8lKLrYFrW7O8cavAqPGx3lcd5uX4AZsLOAOy8GT0LGpEjhfLPuhZoNfJh1Dfc_jRkKP21O2TyveR_FeKviS</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">OeTgAFi7Gr</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">oSeLJy4M8C4DxvqOG</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">DCMf4k</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b7jlWGViHMw7LqnNx2t5AA</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">__results___files</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">__results___9_2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">png</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">**</span><span class="token plain">References</span><span class="token operator" style="color:#393A34">**</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> Keras </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> Tensorflow documentation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Kaggle</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">www</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">kaggle</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token operator" style="color:#393A34">/</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">introtodeeplearning</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> MIT Deep</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Learning course</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-04-25T22:00:00.000Z">Apr 25, 2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/zettelkasten/pandas"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Pandas</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zettelkasten/tutorials/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tutorials</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#single-neuron" class="table-of-contents__link toc-highlight">Single neuron</a></li><li><a href="#linear-units-in-keras" class="table-of-contents__link toc-highlight">Linear Units in Keras</a></li><li><a href="#deep-neural-network" class="table-of-contents__link toc-highlight">Deep neural network</a></li><li><a href="#building-sequential-modelshttpswwwkagglecomcoderyanholbrookdeep-neural-networksbuilding-sequential-models" class="table-of-contents__link toc-highlight">Building Sequential Models(https://www.kaggle.com/code/ryanholbrook/deep-neural-networks#Building-Sequential-Models)</a></li><li><a href="#stochastic-gradient-descent" class="table-of-contents__link toc-highlight">Stochastic gradient descent</a></li><li><a href="#example---red-wine-quality" class="table-of-contents__link toc-highlight">Example - Red Wine Quality</a></li><li><a href="#overfitting-and-underfitting" class="table-of-contents__link toc-highlight">Overfitting and Underfitting</a></li><li><a href="#example---continue" class="table-of-contents__link toc-highlight">Example - Continue</a></li><li><a href="#dropout-and-batch-normalization-some-special-layer-examples" class="table-of-contents__link toc-highlight">Dropout and Batch Normalization (some special layer examples)</a></li><li><a href="#example---using-dropout-and-batch-normalization" class="table-of-contents__link toc-highlight">Example - Using Dropout and Batch Normalization</a></li><li><a href="#binary-classification" class="table-of-contents__link toc-highlight">Binary classification</a></li><li><a href="#example---binary-classification" class="table-of-contents__link toc-highlight">Example - Binary Classification</a></li></ul></div></div></div></div></main></div></div><div class="container" style="margin-top:2rem;margin-bottom:0.175rem;font-size:0.9rem"><div style="display:flex;flex-direction:row;justify-content:space-between"><div><p>ak Â© mmxxii</p></div><div><a href="mailto:me@krishadi.com" style="margin:0 0.5rem"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="footerIcon"><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"></path></svg></a><a href="https://github.com/krish-adi" style="margin:0 0.5rem"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="footerIcon"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a href="https://www.linkedin.com/in/adithyakrishnan/" style="margin:0 0.5rem"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="footerIcon"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a><a href="https://twitter.com/krish_adi_" style="margin:0 0.5rem"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="footerIcon"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a></div></div></div></div>
<script src="/assets/js/runtime~main.130bfcb2.js"></script>
<script src="/assets/js/main.e508e2d1.js"></script>
</body>
</html>